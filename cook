#!/usr/bin/env python
import sys
import re
from subprocess import call


fabfile = None
try:
    from littlechef import fabfile
    file_path = re.sub(r'\.pyc$', '.py', fabfile.__file__)
except ImportError:
    print("Little Chef was not correctly installed: Couldn't import fabfile.py")
    sys.exit(1)

# Act on some arguments and pass others to fabric
args = ['fab', '-f', file_path]
if len(sys.argv) > 1:
    for arg in sys.argv[1:]:
        if arg == '-v' or arg == '-V' or arg == '--version':
            print('LittleChef {0}'.format(fabfile.version))
            sys.argv.remove(arg)
            sys.exit(0)
        else:
            args.append(arg)
else:
    sys.exit("No order given. Type 'cook -l' for a list of orders\n")

# Call fabric with the given arguments
call(args)
